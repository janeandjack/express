{"remainingRequest":"E:\\黎超超\\express\\express\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\黎超超\\express\\express\\src\\views\\admin\\user\\PayPending.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"E:\\黎超超\\express\\express\\src\\views\\admin\\user\\PayPending.vue","mtime":1603936683987},{"path":"E:\\黎超超\\express\\express\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\黎超超\\express\\express\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\黎超超\\express\\express\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\黎超超\\express\\express\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\黎超超\\express\\express\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\黎超超\\express\\express\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmVsLWJyZWFkY3J1bWItb3V0ZXIgew0KICBoZWlnaHQ6IDQ4cHg7DQogIGZvbnQtc2l6ZTogMTVweDsNCiAgYmFja2dyb3VuZC1jb2xvcjogI2YwZjNmNDsNCiAgYm9yZGVyLXJhZGl1czogM3B4Ow0KfQ0KLmJvdHRvbS1tYXJnaW4gew0KICBtYXJnaW4tYm90dG9tOiAxMjBweDsNCn0NCi5lbC1kcm9wZG93bi1pdGVtIHsNCiAgd2lkdGg6IDI2MHB4ICFpbXBvcnRhbnQ7DQogIGhlaWdodDogNTBweDsNCn0NCg=="},{"version":3,"sources":["PayPending.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAs1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PayPending.vue","sourceRoot":"src/views/admin/user","sourcesContent":["<template>\r\n  <div class=\"mt-5 ml-4\">\r\n    <div>\r\n      <el-breadcrumb\r\n        separator-class=\"el-icon-arrow-right\"\r\n        class=\"border el-breadcrumb-outer\"\r\n      >\r\n        <el-breadcrumb-item class=\"mt-3 ml-3\">订单详情</el-breadcrumb-item>\r\n        <el-breadcrumb-item class=\"mt-3\"\r\n          ><span style=\"color:#f39c12;\"\r\n            ><i class=\"fas fa-file-invoice-dollar\" /> 待付款</span\r\n          >\r\n        </el-breadcrumb-item>\r\n        <div class=\"float-right mt-2 mr-3\">\r\n          <el-input\r\n            v-model=\"keyWord\"\r\n            type=\"text\"\r\n            placeholder=\"搜索\"\r\n            class=\"filter-item searchInputWidth\"\r\n            prefix-icon=\"el-icon-search\"\r\n            @input=\"handleQuery\"\r\n            clearable\r\n          />\r\n        </div>\r\n      </el-breadcrumb>\r\n      <div class=\"mt-5\">\r\n        <el-table\r\n          :data=\"tableData\"\r\n          class=\"borderRadius\"\r\n          highlight-current-row\r\n          border\r\n          @selection-change=\"handleSelectionChange\"\r\n        >\r\n          <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\r\n\r\n          <el-table-column\r\n            prop=\"orderId\"\r\n            label=\"订单号\"\r\n            align=\"center\"\r\n            sortable\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <span>{{ row.orderId.substr(-10) }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"shippingCountry\"\r\n            label=\"运至国家\"\r\n            align=\"center\"\r\n            sortable\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <span>{{ row.shippingCountry }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"picture\" label=\"包裹图片\" align=\"center\">\r\n            <template slot-scope=\"{ row }\">\r\n              <el-image\r\n                :src=\"row.picture\"\r\n                fit=\"fill\"\r\n                :preview-src-list=\"[row.picture]\"\r\n              ></el-image>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"orderGoodsList\"\r\n            label=\"订单详情\"\r\n            align=\"center\"\r\n            width=\"160\"\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <div v-for=\"(item, index) in row.orderGoodsList\" :key=\"index\" class=\"border-bottom\">\r\n                <div>\r\n                  货物名称:{{ item.goodName }}\r\n                </div>\r\n                <div>\r\n                  货物数量:{{ item.goodNumber }}\r\n                </div>\r\n              </div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"weight\"\r\n            label=\"重量(kg)\"\r\n            align=\"center\"\r\n            sortable\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <span>{{ row.weight }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"尺寸(cm)\" align=\"center\">\r\n            <template slot-scope=\"{ row }\">\r\n              <div>长: {{ row.orderLength }}</div>\r\n              <div>宽: {{ row.orderWidth }}</div>\r\n              <div>高: {{ row.orderHeight }}</div>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"type\" label=\"类别\" align=\"center\" sortable>\r\n            <template slot-scope=\"{ row }\">\r\n              <span v-if=\"row.type === 0\">粉末货物</span>\r\n              <span v-if=\"row.type === 1\">液体货物</span>\r\n              <span v-if=\"row.type === 2\">食品货物</span>\r\n              <span v-if=\"row.type === 3\">敏感类</span>\r\n              <span v-if=\"row.type === 4\">普通货物</span>\r\n              <span v-if=\"row.type === 5\">体积货物</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"position\"\r\n            label=\"包裹位置\"\r\n            align=\"center\"\r\n            sortable\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              {{ row.position }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"updatedAt\"\r\n            label=\"更新时间\"\r\n            align=\"center\"\r\n            sortable\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              {{\r\n                row.updatedAt\r\n                  | moment(\"timezone\", \"Asia/Shanghai\", \"YYYY-MM-DD HH:mm:ss\")\r\n              }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            prop=\"orderstatus\"\r\n            label=\"订单状态\"\r\n            align=\"center\"\r\n            sortable\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <span class=\"text-success\">{{ row.orderstatus }}</span>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n            label=\"渠道选择\"\r\n            width=\"300\"\r\n            fixed=\"right\"\r\n            align=\"center\"\r\n          >\r\n            <template slot-scope=\"{ row }\">\r\n              <el-form>\r\n                <el-form-item prop=\"expressoptions\">\r\n                  <div v-if=\"row.orderstatus === '已打包'\">\r\n                    <el-select\r\n                      v-model=\"row.chosenExpress\"\r\n                      clearable\r\n                      placeholder=\"请选择快递\"\r\n                    >\r\n                      <el-option\r\n                        style=\"width:260px;\"\r\n                        v-for=\"(item, key) in row.expressoptions.filter(\r\n                          (object) => object.price != null\r\n                        )\"\r\n                        :key=\"key\"\r\n                        :value=\"item.name\"\r\n                      >\r\n                        <div class=\"row\" style=\"width:200px\">\r\n                          <img\r\n                            class=\"col-5 pt-1 pb-1\"\r\n                            :src=\"item.icon\"\r\n                            style=\"width:100%;height:90%;\"\r\n                          />\r\n                          <span class=\"col-7 text-danger\"\r\n                            >{{ item.price }}元 || {{ item.time }}个工作日</span\r\n                          >\r\n                        </div>\r\n                      </el-option>\r\n                    </el-select>\r\n                  </div>\r\n                  <div v-else>\r\n                    <div class=\"mt-3\">\r\n                      <el-select\r\n                        placeholder=\"敬待客服打包\"\r\n                        v-model=\"row.chosenExpress\"\r\n                        disabled\r\n                      >\r\n                      </el-select>\r\n                    </div>\r\n                    <div class=\"mt-2 text-danger\">\r\n                      <i class=\"fas fa-exclamation-triangle mr-2\"></i\r\n                      >客服打包后才可提交支付\r\n                    </div>\r\n                  </div>\r\n                </el-form-item>\r\n              </el-form>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column label=\"操作\" fixed=\"right\" align=\"center\">\r\n            <template slot-scope=\"{ row }\">\r\n              <el-button\r\n                v-if=\"row.orderstatus === '待打包'\"\r\n                type=\"primary\"\r\n                @click=\"handleConfirmReturn(row)\"\r\n                >取消订单</el-button\r\n              >\r\n              <el-button\r\n                v-if=\"row.orderstatus === '已打包'\"\r\n                type=\"primary\"\r\n                @click=\"handleFeesDialog(row)\"\r\n                >取消订单</el-button\r\n              >\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <div class=\"bottom-margin float-right mt-5\">\r\n        <el-button\r\n          v-if=\"\r\n            multipleSelection.filter(\r\n              (object) => object.orderstatus === '已打包'\r\n            ).length === multipleSelection.length &&\r\n              multipleSelection.length > 0 &&\r\n              ChosenExpressRetailSign === true\r\n          \"\r\n          type=\"primary\"\r\n          @click=\"addressSign = true\"\r\n          >提交支付</el-button\r\n        >\r\n        <el-button v-else type=\"primary\" disabled>提交支付</el-button>\r\n      </div>\r\n      <pagination\r\n        :data=\"tableData\"\r\n        class=\"mt-5 float-right\"\r\n        @pagechange=\"pageChange\"\r\n        pager=\"prev, pager, next, jumper, ->, total, slot\"\r\n        limitNumber=\"5\"\r\n      />\r\n      <el-dialog\r\n        title=\"请填写或者选择地址\"\r\n        :visible.sync=\"addressSign\"\r\n        width=\"400px\"\r\n        center\r\n      >\r\n        <p class=\"text-center\" v-if=\"userAccountBalance < expressTotalPrice\">\r\n          <el-link icon=\"el-icon-s-opportunity\" @click=\"switchToUserInfo\"\r\n            >余额不足, 请点击链接充值</el-link\r\n          >\r\n        </p>\r\n        <div v-else>\r\n          <div>\r\n            <span>寄送价格:</span>\r\n            <span class=\"ml-3\">\r\n              <el-tag type=\"danger\" effect=\"dark\"\r\n                >{{ expressTotalPrice }} 元\r\n              </el-tag>\r\n            </span>\r\n            <div class=\"mt-3\">\r\n              <el-radio-group v-model=\"addressRadio\">\r\n                <el-radio :label=\"0\">已存地址</el-radio>\r\n                <el-radio :label=\"1\">手动输入</el-radio>\r\n              </el-radio-group>\r\n            </div>\r\n          </div>\r\n\r\n          <div v-if=\"addressRadio === 0\">\r\n            <el-radio-group\r\n              v-if=\"UserInfoAddress != []\"\r\n              v-model=\"selectedSavedAddress\"\r\n            >\r\n              <el-radio\r\n                v-for=\"(addressItem, index) in UserInfoAddress\"\r\n                :key=\"index\"\r\n                :value=\"index\"\r\n                :label=\"index\"\r\n                class=\"mt-3 ml-1\"\r\n              >\r\n                <div style=\"width:inherit;display:block;white-space:normal;\">\r\n                  <p class=\"row\" style=\"width:370px\">\r\n                    <span class=\"col-5\">具体地址:</span>\r\n                    <span class=\"col-7\">{{ addressItem.ShippingAddress }}</span>\r\n                  </p>\r\n                  <p class=\"row\" style=\"width:370px\">\r\n                    <span class=\"col-5\">城市/省份/邮编: </span>\r\n                    <span class=\"col-7\"\r\n                      >{{ addressItem.ShippingCity }},\r\n                      {{ addressItem.ShippingProvince }},\r\n                      {{ addressItem.ShippingPostcode }}</span\r\n                    >\r\n                  </p>\r\n                  <p class=\"row\" style=\"width:370px\">\r\n                    <span class=\"col-5\">联系信息:</span>\r\n                    <span class=\"col-7\"\r\n                      >{{ addressItem.shippingRecevier }},\r\n                      {{ addressItem.shippingPhone }}</span\r\n                    >\r\n                  </p>\r\n                </div>\r\n              </el-radio>\r\n            </el-radio-group>\r\n            <div class=\"text-danger\" v-else>\r\n              <p class=\"text-center\">\r\n                暂无已存的个人地址\r\n              </p>\r\n              <p>\r\n                <el-link icon=\"el-icon-s-opportunity\" @click=\"switchToUserInfo\"\r\n                  >去个人信息中心完善用户地址信息</el-link\r\n                >\r\n              </p>\r\n              <p>\r\n                <el-link icon=\"el-icon-s-opportunity\" @click=\"addressRadio = 1\"\r\n                  >手动输入地址</el-link\r\n                >\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <div v-else class=\"mt-2 ml-2\">\r\n            <el-form\r\n              :model=\"DeliveryAddressForm\"\r\n              label-position=\"left\"\r\n              label-width=\"100px\"\r\n            >\r\n              <el-form-item label=\"*寄送省份:\">\r\n                <el-input\r\n                  v-model=\"DeliveryAddressForm.ShippingProvince\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"*寄送城市:\">\r\n                <el-input\r\n                  v-model=\"DeliveryAddressForm.ShippingCity\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"*具体地址:\">\r\n                <el-input\r\n                  v-model=\"DeliveryAddressForm.ShippingAddress\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"*地址邮编:\">\r\n                <el-input\r\n                  v-model=\"DeliveryAddressForm.ShippingPostcode\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"*收件人:\">\r\n                <el-input\r\n                  v-model=\"DeliveryAddressForm.ShippingReceiver\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"*联系电话:\">\r\n                <el-input\r\n                  v-model=\"DeliveryAddressForm.ShippingPhone\"\r\n                  autocomplete=\"off\"\r\n                ></el-input>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </div>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"addressSign = false\">取消</el-button>\r\n          <el-button\r\n            v-if=\"addressRadio == 0 && selectedSavedAddress != 2\"\r\n            type=\"primary\"\r\n            @click=\"\r\n              payCodeSign = true;\r\n              addressSign = false;\r\n            \"\r\n            >确定</el-button\r\n          >\r\n          <el-button\r\n            v-else-if=\"\r\n              addressRadio == 1 &&\r\n                DeliveryAddressForm.ShippingProvince !== '' &&\r\n                DeliveryAddressForm.ShippingCity !== '' &&\r\n                DeliveryAddressForm.ShippingAddress !== '' &&\r\n                DeliveryAddressForm.ShippingPostcode !== '' &&\r\n                DeliveryAddressForm.ShippingReceiver !== '' &&\r\n                DeliveryAddressForm.ShippingPhone !== ''\r\n            \"\r\n            type=\"primary\"\r\n            @click=\"\r\n              payCodeSign = true;\r\n              addressSign = false;\r\n            \"\r\n            >确定</el-button\r\n          >\r\n          <el-button v-else type=\"primary\" disabled>确定</el-button>\r\n        </span>\r\n      </el-dialog>\r\n\r\n      <el-dialog\r\n        v-loading=\"loading\"\r\n        title=\"支付快递费用\"\r\n        :visible.sync=\"payCodeSign\"\r\n        width=\"400px\"\r\n        center\r\n      >\r\n        <span></span>\r\n        <p class=\"text-center mt-3\" style=\"font-size:18px;\">\r\n          <i class=\"fas fa-exclamation-circle text-warning mr-2\"></i\r\n          >账户余额为<span class=\"text-danger ml-1 mr-1\">{{\r\n            userAccountBalance\r\n          }}</span\r\n          >元\r\n        </p>\r\n        <p class=\"text-center mt-3\" style=\"font-size:18px;\">\r\n          <i class=\"fas fa-yen-sign text-danger mr-2\"></i> 快递费用为<span\r\n            class=\"text-info ml-1 mr-1\"\r\n            >{{ expressTotalPrice }}</span\r\n          >元\r\n        </p>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"payCodeSign = false\">取消</el-button>\r\n          <el-button\r\n            v-if=\"userAccountBalance < expressTotalPrice\"\r\n            type=\"primary\"\r\n            disabled\r\n            >确定</el-button\r\n          >\r\n          <el-button v-else type=\"primary\" @click=\"submitPayAddress\"\r\n            >确定</el-button\r\n          >\r\n        </span>\r\n      </el-dialog>\r\n\r\n      <el-dialog\r\n        title=\"支付退货费用\"\r\n        :visible.sync=\"returnFeesPaySign\"\r\n        width=\"400px\"\r\n        center\r\n      >\r\n        <span class=\"text-danger\" style=\"margin-left:65px;\"\r\n          ><i class=\"fas fa-exclamation-circle\"></i>\r\n          已打包商品退货须支付20元手续费</span\r\n        >\r\n        <p class=\"text-center mt-3\">\r\n          账户余额为<span class=\"text-info ml-1 mr-1\">{{\r\n            userAccountBalance\r\n          }}</span\r\n          >元\r\n        </p>\r\n        <p class=\"text-center mt-3\">\r\n          取消订单手续费用为<span class=\"text-info ml-1 mr-1\">20</span>元\r\n        </p>\r\n        <p class=\"text-center\" v-if=\"userAccountBalance < 20\">\r\n          <el-link icon=\"el-icon-s-opportunity\" @click=\"switchToUserInfo\"\r\n            >余额不足, 请点击链接充值</el-link\r\n          >\r\n        </p>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button @click=\"returnFeesPaySign = false\">取消</el-button>\r\n          <el-button v-if=\"userAccountBalance < 20\" type=\"primary\" disabled\r\n            >确定</el-button\r\n          >\r\n          <el-button v-else type=\"primary\" @click=\"submitReturnOrder\"\r\n            >确定</el-button\r\n          >\r\n        </span>\r\n      </el-dialog>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  reactive,\r\n  computed,\r\n  onMounted,\r\n  ref,\r\n  inject,\r\n} from \"@vue/composition-api\";\r\nimport pagination from \"../components/InfoPagination\";\r\nimport { imageDomain } from \"@/MainAPI.js\";\r\nexport default {\r\n  components: {\r\n    pagination,\r\n  },\r\n  setup(props, { root: { $store, $router, $message, $confirm } }) {\r\n    onMounted(() => {\r\n      $store.dispatch(\"getOrderForm\", {\r\n        status: \"已打包\",\r\n        page: \"0\",\r\n        size: \"5\",\r\n        status1: \"待打包\",\r\n      });\r\n      $store.dispatch(\"getUserInfo\");\r\n    });\r\n\r\n    const loading = ref(false);\r\n\r\n    //table data for display\r\n    const payOrderList = computed(() => {\r\n      return $store.state.selforderlist;\r\n    });\r\n    const keyWord = ref(\"\");\r\n    const returnData = ref([]);\r\n    const handleQuery = () => {\r\n      let data = {\r\n        keyword: { searchString: keyWord.value },\r\n        status: \"已打包\",\r\n        page: \"0\",\r\n        size: \"5\",\r\n        status1: \"待打包\",\r\n      };\r\n      $store\r\n        .dispatch(\"searchOrdersForUser\", data)\r\n        .then((res) => {\r\n          returnData.value = res.data;\r\n        })\r\n        .catch(() => {});\r\n    };\r\n    const tableData = computed(() => {\r\n      let data = [];\r\n      if (keyWord.value != \"\") {\r\n        data = returnData.value;\r\n      } else {\r\n        data = payOrderList.value;\r\n      }\r\n      return data.map((object) => {\r\n        if (!object.retailPriceAndTime) {\r\n          return {\r\n            orderId: object._id,\r\n            picture:\r\n              \"https://cdn.pixabay.com/photo/2017/07/08/10/44/parcel-2484036_1280.png\",\r\n            weight: \"\",\r\n            orderLength: \"\",\r\n            orderWidth: \"\",\r\n            orderHeight: \"\",\r\n            type: \"\",\r\n            position: \"\",\r\n            shippingCountry: object.shippingCountry,\r\n            orderGoodsList: object.orderGoodsList,\r\n            expressoptions: [],\r\n            chosenExpress: \"\",\r\n            orderstatus: object.orderStatus,\r\n            updatedAt: object.updatedAt,\r\n          };\r\n        } else {\r\n          return {\r\n            orderId: object._id,\r\n            picture: imageDomain + object.orderImg,\r\n            weight: object.orderWeight,\r\n            orderLength: object.orderSize_length,\r\n            orderWidth: object.orderSize_width,\r\n            orderHeight: object.orderSize_height,\r\n            type: object.orderType,\r\n            position: object.packageLocation,\r\n            shippingCountry: object.shippingCountry,\r\n            orderGoodsList: object.orderGoodsList,\r\n            expressoptions: [\r\n              {\r\n                name: \"DHL\",\r\n                icon: \"/images/ExpressIcon/dhl.png\",\r\n                price: object.retailPriceAndTime.DHL.price,\r\n                time: object.retailPriceAndTime.DHL.time,\r\n              },\r\n              {\r\n                name: \"UPS\",\r\n                icon: \"/images/ExpressIcon/ups.png\",\r\n                price: object.retailPriceAndTime.UPS.price,\r\n                time: object.retailPriceAndTime.UPS.time,\r\n              },\r\n              {\r\n                name: \"FedEx\",\r\n                icon: \"/images/ExpressIcon/fedex.png\",\r\n                price: object.retailPriceAndTime.FedEx.price,\r\n                time: object.retailPriceAndTime.FedEx.time,\r\n              },\r\n              {\r\n                name: \"TNT\",\r\n                icon: \"/images/ExpressIcon/tnt.png\",\r\n                price: object.retailPriceAndTime.TNT.price,\r\n                time: object.retailPriceAndTime.TNT.time,\r\n              },\r\n              {\r\n                name: \"EMS\",\r\n                icon: \"/images/ExpressIcon/ems.png\",\r\n                price: object.retailPriceAndTime.EMS.price,\r\n                time: object.retailPriceAndTime.EMS.time,\r\n              },\r\n              {\r\n                name: \"Special\",\r\n                icon: \"/images/ExpressIcon/special.png\",\r\n                price: object.retailPriceAndTime.Special.price,\r\n                time: object.retailPriceAndTime.Special.time,\r\n              },\r\n            ],\r\n            chosenExpress: object.orderExpressRetail,\r\n            orderstatus: object.orderStatus,\r\n            updatedAt: object.updatedAt,\r\n          };\r\n        }\r\n      });\r\n    });\r\n    const pageChange = (val) => {\r\n      if (keyWord.value === \"\") {\r\n        $store.dispatch(\"getOrderForm\", {\r\n          status: \"已打包\",\r\n          page: val - 1,\r\n          size: 5,\r\n          status1: \"待打包\",\r\n        });\r\n      } else {\r\n        $store\r\n          .dispatch(\"searchOrdersForUser\", {\r\n            keyword: { searchString: keyWord.value },\r\n            status: \"已打包\",\r\n            page: val - 1,\r\n            size: 5,\r\n            status1: \"待打包\",\r\n          })\r\n          .then((res) => {\r\n            returnData.value = res.data;\r\n          })\r\n          .catch(() => {});\r\n      }\r\n    };\r\n\r\n    //cancel order\r\n    const returnFeesPaySign = ref(false);\r\n    const returnOrderId = ref(\"\");\r\n    const orderGoodsList = ref([]);\r\n    const handleFeesDialog = (row) => {\r\n      returnFeesPaySign.value = true;\r\n      returnOrderId.value = row.orderId;\r\n      orderGoodsList.value = row.orderGoodsList;\r\n    };\r\n    const handleConfirmReturn = (row) => {\r\n      $confirm(\"确定取消订单?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      })\r\n        .then(() => {\r\n          let data = {\r\n            id: row.orderId,\r\n            data: { orderGoodsList: row.orderGoodsList },\r\n          };\r\n          $store\r\n            .dispatch(\"cancleOrderForm\", data)\r\n            .then(() => {\r\n              $message.success(\"订单更新成功！\");\r\n\r\n              toReload();\r\n            })\r\n            .catch(() => {});\r\n        })\r\n        .catch(() => {\r\n          $message({\r\n            type: \"info\",\r\n            message: \"取消\",\r\n          });\r\n        });\r\n    };\r\n\r\n    const submitReturnOrder = () => {\r\n      let data = {\r\n        id: returnOrderId.value,\r\n        data: { \r\n          orderGoodsList: orderGoodsList.value,\r\n        },\r\n      };\r\n      let paydata = {\r\n        payBalance: 20,\r\n      };\r\n      $store\r\n        .dispatch(\"payFromAccount\", paydata)\r\n        .then(() => {\r\n          $message.success(\"付款成功！\");\r\n          $store\r\n            .dispatch(\"cancleOrderForm\", data)\r\n            .then(() => {\r\n              $message.success(\"订单取消成功！\");\r\n              toReload();\r\n            })\r\n            .catch(() => {});\r\n        })\r\n        .catch(() => {});\r\n    };\r\n\r\n    //pay the order\r\n    const toReload = inject(\"reload\");\r\n    const multipleSelection = ref([]);\r\n    const handleSelectionChange = (val) => {\r\n      multipleSelection.value = val;\r\n    };\r\n    const addressSign = ref(false);\r\n    const addressRadio = ref(0);\r\n    const selectedSavedAddress = ref(2);\r\n    const UserInfoAddress = computed(() => {\r\n      return $store.state.userSelf.address;\r\n    });\r\n\r\n    const expressTotalPrice = computed(() => {\r\n      let a = multipleSelection.value.map((object) => {\r\n        return object.expressoptions\r\n          .filter((item) => item.name == object.chosenExpress)\r\n          .map((object) => {\r\n            return object.price;\r\n          })[0];\r\n      });\r\n      let result = 0;\r\n      for (let i of a) {\r\n        result = result + i;\r\n      }\r\n      return result;\r\n    });\r\n\r\n    const ChosenExpressRetailSign = computed(() => {\r\n      let temp = multipleSelection.value.filter(\r\n        (object) => object.chosenExpress === undefined\r\n      );\r\n      if (temp.length === 0) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    });\r\n    const DeliveryAddressForm = reactive({\r\n      ShippingProvince: \"\",\r\n      ShippingCity: \"\",\r\n      ShippingAddress: \"\",\r\n      ShippingPostcode: \"\",\r\n      ShippingReceiver: \"\",\r\n      ShippingPhone: \"\",\r\n    });\r\n    const payCodeSign = ref(false);\r\n    const submitPayAddress = () => {\r\n      loading.value = true;\r\n      payCodeSign.value = false;\r\n      if (addressRadio.value == 0) {\r\n        let data = multipleSelection.value.map((object) => {\r\n          return {\r\n            orderId: object.orderId,\r\n            shippingProvince:\r\n              UserInfoAddress.value[selectedSavedAddress.value]\r\n                .ShippingProvince,\r\n            shippingCity:\r\n              UserInfoAddress.value[selectedSavedAddress.value].ShippingCity,\r\n            shippingAddress:\r\n              UserInfoAddress.value[selectedSavedAddress.value].ShippingAddress,\r\n            shippingPostcode:\r\n              UserInfoAddress.value[selectedSavedAddress.value]\r\n                .ShippingPostcode,\r\n            shippingPhone:\r\n              UserInfoAddress.value[selectedSavedAddress.value].shippingPhone,\r\n            shippingRecevier:\r\n              UserInfoAddress.value[selectedSavedAddress.value]\r\n                .shippingRecevier,\r\n            orderExpressRetail: object.chosenExpress,\r\n            incomePrice: expressTotalPrice.value,\r\n          };\r\n        });\r\n        let paydata = {\r\n          payBalance: expressTotalPrice.value,\r\n        };\r\n        $store\r\n          .dispatch(\"payFromAccount\", paydata)\r\n          .then(() => {\r\n            $message.success(\"付款成功！\");\r\n            $store\r\n              .dispatch(\"orderDelivery\", data)\r\n              .then(() => {\r\n                $message.success(\"订单更新成功！\");\r\n                loading.value = false;\r\n                toReload();\r\n              })\r\n              .catch(() => {\r\n                loading.value = false;\r\n              });\r\n          })\r\n          .catch(() => {});\r\n      } else {\r\n        let data = multipleSelection.value.map((object) => {\r\n          return {\r\n            orderId: object.orderId,\r\n            shippingProvince: DeliveryAddressForm.ShippingProvince,\r\n            shippingCity: DeliveryAddressForm.ShippingCity,\r\n            shippingAddress: DeliveryAddressForm.ShippingAddress,\r\n            shippingPostcode: DeliveryAddressForm.ShippingPostcode,\r\n            shippingPhone: DeliveryAddressForm.ShippingPhone,\r\n            shippingRecevier: DeliveryAddressForm.ShippingReceiver,\r\n            orderExpressRetail: object.chosenExpress,\r\n            incomePrice: expressTotalPrice.value,\r\n          };\r\n        });\r\n        let paydata = {\r\n          payBalance: expressTotalPrice.value,\r\n        };\r\n        $store\r\n          .dispatch(\"payFromAccount\", paydata)\r\n          .then(() => {\r\n            $message.success(\"付款成功！\");\r\n            $store\r\n              .dispatch(\"orderDelivery\", data)\r\n              .then(() => {\r\n                $message.success(\"邮寄填写成功！\");\r\n                loading.value = false;\r\n                toReload();\r\n              })\r\n              .catch(() => {\r\n                loading.value = false;\r\n              });\r\n          })\r\n          .catch(() => {});\r\n      }\r\n    };\r\n    const switchToUserInfo = () => {\r\n      $router.push(\"/dashboard/useraccountinfo\");\r\n      toReload();\r\n    };\r\n\r\n    const handleClose = () => {\r\n      toReload();\r\n    };\r\n\r\n    const userAccountBalance = computed(() => {\r\n      return $store.state.userSelf.balance;\r\n    });\r\n\r\n    return {\r\n      loading,\r\n      keyWord,\r\n      handleQuery,\r\n      payOrderList,\r\n      tableData,\r\n      pageChange,\r\n\r\n      returnFeesPaySign,\r\n      submitReturnOrder,\r\n      handleFeesDialog,\r\n      switchToUserInfo,\r\n      handleConfirmReturn,\r\n\r\n      multipleSelection,\r\n      handleSelectionChange,\r\n      ChosenExpressRetailSign,\r\n      UserInfoAddress,\r\n      selectedSavedAddress,\r\n      addressSign,\r\n      addressRadio,\r\n      DeliveryAddressForm,\r\n      expressTotalPrice,\r\n      payCodeSign,\r\n      submitPayAddress,\r\n\r\n      handleClose,\r\n      userAccountBalance,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.el-breadcrumb-outer {\r\n  height: 48px;\r\n  font-size: 15px;\r\n  background-color: #f0f3f4;\r\n  border-radius: 3px;\r\n}\r\n.bottom-margin {\r\n  margin-bottom: 120px;\r\n}\r\n.el-dropdown-item {\r\n  width: 260px !important;\r\n  height: 50px;\r\n}\r\n</style>\r\n"]}]}